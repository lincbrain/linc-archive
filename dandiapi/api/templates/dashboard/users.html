{% extends "dashboard/base.html" %}

{% block title %} Data Dashboard: Users {% endblock %}

{% block content %}
<div>
  <h1>Users</h1>

  <div style="margin-bottom: 2%;">
    <form action="" method="get">
      {{ filter.form.as_p }}
      <input type="submit" value="Apply filter" />
    </form>
    {% for value in filter.data.values %}
      <p>There are currently {{ filter.qs.count }} {{ value }} users.</p>
    {% endfor %}
  </div>

  <!-- Two different tables so that emails can be copied easily -->
  <table style="float: left">
    <thead>
      <tr>
        <td>Email</td>
      </tr>
    </thead>
    {% for user in filter.qs %}
    <tr>
      <td>{{ user.email }}</td>
    </tr>
    {% endfor %}
  </table>
  <table style="float: left">
    <thead>
      <tr>
        <td>First name</td>
        <td>Last name</td>
        <td>Date joined</td>
        <td>Status</td>
      </tr>
    </thead>
    {% for user in filter.qs %}
    <tr>
      <td>{{ user.first_name }}</td>
      <td>{{ user.last_name }}</td>
      <td>{{ user.date_joined }}</td>
      <td><a href="{% url 'user-approval' user.username %}">{{ user.metadata.status }}</a></td>
    </tr>
    {% endfor %}
  </table>
</div>
{% endblock content %}
